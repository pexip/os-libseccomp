From c3559610ffdcda23a7fbd38fea86f8ed81fb16b0 Mon Sep 17 00:00:00 2001
From: Paul Moore <paul@paul-moore.com>
Date: Mon, 23 Aug 2021 11:21:39 -0400
Subject: [PATCH] syscalls: update to Linux v5.14-rc7

Signed-off-by: Paul Moore <paul@paul-moore.com>
---
 include/seccomp-syscalls.h | 7 +++++++
 src/syscalls.csv           | 7 ++++++-
 2 files changed, 13 insertions(+), 1 deletion(-)

diff --git a/include/seccomp-syscalls.h b/include/seccomp-syscalls.h
index 1ca500be..7075f3f6 100644
--- a/include/seccomp-syscalls.h
+++ b/include/seccomp-syscalls.h
@@ -275,6 +275,7 @@
 #define __PNR_ppoll				-10241
 #define __PNR_renameat				-10242
 #define __PNR_riscv_flush_icache		-10243
+#define __PNR_memfd_secret			-10244
 
 /*
  * libseccomp syscall definitions
@@ -1084,6 +1085,12 @@
 #define __SNR_memfd_create		__PNR_memfd_create
 #endif
 
+#ifdef __NR_memfd_secret
+#define __SNR_memfd_secret		__NR_memfd_secret
+#else
+#define __SNR_memfd_secret		__PNR_memfd_secret
+#endif
+
 #ifdef __NR_migrate_pages
 #define __SNR_migrate_pages		__NR_migrate_pages
 #else
diff --git a/src/syscalls.csv b/src/syscalls.csv
index 4c828697..af06a64d 100644
--- a/src/syscalls.csv
+++ b/src/syscalls.csv
@@ -1,4 +1,4 @@
-#syscall (v5.12.0-rc7 2021-04-17),x86,x86_64,x32,arm,aarch64,mips,mips64,mips64n32,parisc,parisc64,ppc,ppc64,riscv64,s390,s390x
+#syscall (v5.14.0-rc7 2021-08-23),x86,x86_64,x32,arm,aarch64,mips,mips64,mips64n32,parisc,parisc64,ppc,ppc64,riscv64,s390,s390x
 accept,PNR,43,43,285,202,168,42,42,35,35,330,330,202,PNR,PNR
 accept4,364,288,288,366,242,334,293,297,320,320,344,344,242,364,364
 access,33,21,21,33,PNR,33,20,20,33,33,33,33,PNR,33,33
@@ -168,6 +168,9 @@ kexec_file_load,PNR,320,320,401,294,PNR,PNR,PNR,355,355,382,382,294,381,381
 kexec_load,283,246,528,347,104,311,270,274,300,300,268,268,104,277,277
 keyctl,288,250,250,311,219,282,241,245,266,266,271,271,219,280,280
 kill,37,62,62,37,129,37,60,60,37,37,37,37,129,37,37
+landlock_add_rule,445,445,445,445,445,445,445,445,445,445,445,445,445,445,445
+landlock_create_ruleset,444,444,444,444,444,444,444,444,444,444,444,444,444,444,444
+landlock_restrict_self,446,446,446,446,446,446,446,446,446,446,446,446,446,446,446
 lchown,16,94,94,16,PNR,16,92,92,16,16,16,16,PNR,16,198
 lchown32,198,PNR,PNR,198,PNR,PNR,PNR,PNR,PNR,PNR,PNR,PNR,PNR,198,PNR
 lgetxattr,230,192,192,230,9,228,184,184,242,242,213,213,9,228,228
@@ -188,6 +191,7 @@ madvise,219,28,28,220,233,218,27,27,119,119,205,205,233,219,219
 mbind,274,237,237,319,235,268,227,231,260,260,259,259,235,268,268
 membarrier,375,324,324,389,283,358,318,322,343,343,365,365,283,356,356
 memfd_create,356,319,319,385,279,354,314,318,340,340,360,360,279,350,350
+memfd_secret,447,447,447,PNR,447,PNR,PNR,PNR,PNR,PNR,PNR,PNR,PNR,PNR,PNR
 migrate_pages,294,256,256,400,238,287,246,250,272,272,258,258,238,287,287
 mincore,218,27,27,219,232,217,26,26,72,72,206,206,232,218,218
 mkdir,39,83,83,39,PNR,39,81,81,39,39,39,39,PNR,39,39
@@ -277,6 +281,7 @@ pwritev,334,296,535,362,70,331,290,294,316,316,321,321,70,329,329
 pwritev2,379,328,547,393,287,362,322,326,348,348,381,381,287,377,377
 query_module,167,178,PNR,PNR,PNR,187,171,171,PNR,PNR,166,166,PNR,167,167
 quotactl,131,179,179,131,60,131,172,172,131,131,131,131,60,131,131
+quotactl_fd,443,443,443,443,443,443,443,443,443,443,443,443,443,443,443
 read,3,0,0,3,63,3,0,0,3,3,3,3,63,3,3
 readahead,225,187,187,225,213,223,179,179,207,207,191,191,213,222,222
 readdir,89,PNR,PNR,PNR,PNR,89,PNR,PNR,PNR,PNR,89,89,PNR,89,89
