From 9cfe96d42385b3000e2afd96360007fd554417c1 Mon Sep 17 00:00:00 2001
From: Paul Moore <paul@paul-moore.com>
Date: Thu, 4 Nov 2021 09:09:49 -0600
Subject: [PATCH] syscalls: update the syscall table to Linux v5.15

Signed-off-by: Paul Moore <paul@paul-moore.com>
Signed-off-by: Tom Hromatka <tom.hromatka@oracle.com>
---
 include/seccomp-syscalls.h | 2 ++
 src/syscalls.csv           | 3 ++-
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/include/seccomp-syscalls.h b/include/seccomp-syscalls.h
index 4baa307a..8019d29e 100644
--- a/include/seccomp-syscalls.h
+++ b/include/seccomp-syscalls.h
@@ -1403,6 +1403,8 @@
 
 #define __SNR_process_madvise		__NR_process_madvise
 
+#define __SNR_process_mrelease		__NR_process_mrelease
+
 #define __SNR_process_vm_readv		__NR_process_vm_readv
 
 #define __SNR_process_vm_writev		__NR_process_vm_writev
diff --git a/src/syscalls.csv b/src/syscalls.csv
index af06a64d..53a639a5 100644
--- a/src/syscalls.csv
+++ b/src/syscalls.csv
@@ -1,4 +1,4 @@
-#syscall (v5.14.0-rc7 2021-08-23),x86,x86_64,x32,arm,aarch64,mips,mips64,mips64n32,parisc,parisc64,ppc,ppc64,riscv64,s390,s390x
+#syscall (v5.15.0 2021-11-03),x86,x86_64,x32,arm,aarch64,mips,mips64,mips64n32,parisc,parisc64,ppc,ppc64,riscv64,s390,s390x
 accept,PNR,43,43,285,202,168,42,42,35,35,330,330,202,PNR,PNR
 accept4,364,288,288,366,242,334,293,297,320,320,344,344,242,364,364
 access,33,21,21,33,PNR,33,20,20,33,33,33,33,PNR,33,33
@@ -268,6 +268,7 @@ preadv,333,295,534,361,69,330,289,293,315,315,320,320,69,328,328
 preadv2,378,327,546,392,286,361,321,325,347,347,380,380,286,376,376
 prlimit64,340,302,302,369,261,338,297,302,321,321,325,325,261,334,334
 process_madvise,440,440,440,440,440,440,440,440,440,440,440,440,440,440,440
+process_mrelease,448,448,448,448,448,448,448,448,448,448,448,448,448,448,448
 process_vm_readv,347,310,539,376,270,345,304,309,330,330,351,351,270,340,340
 process_vm_writev,348,311,540,377,271,346,305,310,331,331,352,352,271,341,341
 prof,44,PNR,PNR,PNR,PNR,44,PNR,PNR,PNR,PNR,44,44,PNR,PNR,PNR
